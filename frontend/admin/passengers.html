<!doctype html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Пасажири</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body data-page="passengers">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="dashboard.html">Bus CRM</a>
  </div>
</nav>
<div class="container">
  <h3>Пасажири рейсу</h3>
  <form id="passengers-form" class="row g-2">
    <div class="col-md-4"><input id="tripId" class="form-control" placeholder="Trip ID"></div>
    <div class="col-md-2"><button class="btn btn-primary" type="submit">Показати</button></div>
  </form>
  <table class="table table-bordered mt-3">
    <thead><tr><th>ID</th><th>Пасажир</th><th>Телефон</th><th>Місце</th><th>Статус</th></tr></thead>
    <tbody id="passengers-body"></tbody>
  </table>
</div>
<script src="scripts.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('passengers-form');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const tripId = document.getElementById('tripId').value;
    const res = await fetch(`${API_URL}/trips/${tripId}/passengers`, { headers: authHeaders() });
    const data = await res.json();
    const tbody = document.getElementById('passengers-body');
    tbody.innerHTML = '';
    data.forEach((p) => {
      const tr = document.createElement('tr');
      ['id','passenger_name','passenger_phone','seat_number','status'].forEach((k)=>{
        const td = document.createElement('td');
        td.innerText = p[k];
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  });
});
</script>
</body>
</html>
