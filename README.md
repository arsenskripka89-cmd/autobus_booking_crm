# Автобусна CRM

Повноцінна CRM для автобусних перевезень з backend на Express + SQLite, Telegram/Viber ботами та Bootstrap-адмінкою.

## Швидкий старт
1. Встановіть залежності: `npm install`
2. Запустіть сервер: `npm start` (PORT=3000 за замовчуванням)
3. Адмінка: `http://localhost:3000/admin/login.html`
4. Дефолтний адмін: телефон `+10000000000`, пароль `admin123`

## Стек
- Node.js, Express, sqlite3
- Telegraf (Telegram), Viber Bot API
- Bootstrap 5 для адмінки

## Структура
- `backend/` – API, middleware, сервіси, боти
- `frontend/admin` – HTML/CSS/JS адмінки
- `frontend/public` – статичні файли (логотип)

## Функціонал
- JWT-аутентифікація та ролі (admin, manager, driver)
- CRUD для користувачів, маршрутів, автобусів, рейсів
- Генерація рейсів на кілька днів наперед
- Бронювання з перевіркою вільних місць, скасуванням та списками пасажирів
- Розсилки через Telegram та Viber
- Телеграм/Viber боти з меню бронювання та перегляду рейсів

## Налаштування ботів
Встановіть токени у змінні середовища:
```
TELEGRAM_BOT_TOKEN=...
VIBER_BOT_TOKEN=...
WEBHOOK_URL=https://your-host
```
При відсутності токенів боти не стартують, але бекенд та адмінка працюватимуть.

## Ролі доступу
- **admin** – повний доступ
- **manager** – управління даними без редагування ролей
- **driver** – перегляд списку пасажирів

## Запуск на Replit
- Стартова команда: `npm start`
- Вкажіть `PORT` у налаштуваннях, Replit пробросить публічний URL для WEBHOOK_URL.

## Логи та помилки
- Використовується `morgan` для логування HTTP
- Єдине middleware повертає помилки у форматі `{ message }`
